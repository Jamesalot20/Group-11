{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\james\\\\OneDrive\\\\Documents\\\\GitHub\\\\Group-11\\\\frontend\\\\src\\\\components\\\\Checkout.js\",\n  _s = $RefreshSig$();\nimport React, { useContext } from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport { CartContext } from './CartContext';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nfunction Checkout() {\n  _s();\n  const navigate = useNavigate();\n  const {\n    cartItems,\n    productDetails\n  } = useContext(CartContext);\n  console.log('cartItems:', cartItems, 'productDetails:', productDetails);\n  const totalPrice = cartItems.reduce((total, item) => {\n    const product = productDetails[item.product];\n    return total + (product ? product.price * item.quantity : 0);\n  }, 0);\n  const handleSubmit = async e => {\n    e.preventDefault();\n    const items = cartItems.map(item => {\n      const product = productDetails[item.product];\n      if (!product) {\n        console.error(`Product with ID ${item.product} not found`);\n        return null;\n      }\n      return {\n        product: item.product,\n        name: product.name,\n        price: product.price,\n        quantity: item.quantity,\n        seller: product.seller\n      };\n    }).filter(item => item !== null);\n    const sellerIds = [...new Set(items.map(item => item.seller))];\n    const orderData = {\n      items,\n      total: totalPrice,\n      totalPrice,\n      buyer: localStorage.getItem('userId'),\n      // Make sure this key matches the one you used when storing the user ID\n      sellerIds\n    };\n    try {\n      await createOrder(orderData);\n      navigate('/Completion');\n    } catch (error) {\n      console.error('Failed to submit order:', error);\n    }\n  };\n  async function createOrder(orderData) {\n    try {\n      const response = await fetch('http://localhost:5000/api/orders', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          Authorization: `Bearer ${localStorage.getItem('userId')}`\n        },\n        body: JSON.stringify(orderData)\n      });\n      if (!response.ok) {\n        throw new Error(`Failed to submit order: ${response.status}`);\n      }\n\n      // Handle successful order submission\n      const order = await response.json();\n      console.log('Order created:', order);\n      navigate('/Store');\n    } catch (error) {\n      console.error(error);\n    }\n  }\n  return /*#__PURE__*/_jsxDEV(\"form\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n      children: \"Checkout\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: [\"Total: $\", totalPrice.toFixed(2)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"Products\",\n      children: cartItems.map((item, index) => {\n        const product = productDetails[item.product];\n        return product ? /*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n            children: product.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Price: $\", product.price]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 86,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: [\"Quantity: \", item.quantity]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 87,\n            columnNumber: 15\n          }, this)]\n        }, index, true, {\n          fileName: _jsxFileName,\n          lineNumber: 84,\n          columnNumber: 13\n        }, this) : null;\n      })\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mb-3\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 93,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"d-grid\",\n      children: /*#__PURE__*/_jsxDEV(\"a\", {\n        href: \"Completion\",\n        children: /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"submit\",\n          className: \"btn btn-primary\",\n          onClick: handleSubmit,\n          children: \"Submit\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 98,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 7\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 76,\n    columnNumber: 5\n  }, this);\n}\n_s(Checkout, \"7d3m4gVoL8mwxa2hpl8fkCNEsCQ=\", false, function () {\n  return [useNavigate];\n});\n_c = Checkout;\nexport default Checkout;\nvar _c;\n$RefreshReg$(_c, \"Checkout\");","map":{"version":3,"names":["React","useContext","useNavigate","CartContext","jsxDEV","_jsxDEV","Checkout","_s","navigate","cartItems","productDetails","console","log","totalPrice","reduce","total","item","product","price","quantity","handleSubmit","e","preventDefault","items","map","error","name","seller","filter","sellerIds","Set","orderData","buyer","localStorage","getItem","createOrder","response","fetch","method","headers","Authorization","body","JSON","stringify","ok","Error","status","order","json","children","fileName","_jsxFileName","lineNumber","columnNumber","toFixed","className","index","href","type","onClick","_c","$RefreshReg$"],"sources":["C:/Users/james/OneDrive/Documents/GitHub/Group-11/frontend/src/components/Checkout.js"],"sourcesContent":["import React, { useContext } from 'react';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { CartContext } from './CartContext';\r\n\r\nfunction Checkout() {\r\n  const navigate = useNavigate();\r\n  const { cartItems, productDetails } = useContext(CartContext);\r\nconsole.log('cartItems:', cartItems, 'productDetails:', productDetails);\r\n  const totalPrice = cartItems.reduce((total, item) => {\r\n    const product = productDetails[item.product];\r\n    return total + (product ? product.price * item.quantity : 0);\r\n  }, 0);\r\n\r\nconst handleSubmit = async (e) => {\r\n  e.preventDefault();\r\n\r\n  const items = cartItems.map((item) => {\r\n  const product = productDetails[item.product];\r\n\r\n  if (!product) {\r\n    console.error(`Product with ID ${item.product} not found`);\r\n    return null;\r\n  }\r\n\r\n  return {\r\n    product: item.product,\r\n    name: product.name,\r\n    price: product.price,\r\n    quantity: item.quantity,\r\n    seller: product.seller,\r\n  };\r\n}).filter(item => item !== null);\r\n\r\nconst sellerIds = [...new Set(items.map(item => item.seller))];\r\n  const orderData = {\r\n  items,\r\n  total: totalPrice,\r\n  totalPrice,\r\n  buyer: localStorage.getItem('userId'), // Make sure this key matches the one you used when storing the user ID\r\n  sellerIds,\r\n};\r\n\r\n  try {\r\n    await createOrder(orderData);\r\n    navigate('/Completion');\r\n  } catch (error) {\r\n    console.error('Failed to submit order:', error);\r\n  }\r\n};\r\n\r\nasync function createOrder(orderData) {\r\n  try {\r\n    const response = await fetch('http://localhost:5000/api/orders', {\r\n      method: 'POST',\r\n      headers: {\r\n        'Content-Type': 'application/json',\r\n        Authorization: `Bearer ${localStorage.getItem('userId')}`,\r\n      },\r\n      body: JSON.stringify(orderData),\r\n    });\r\n\r\n    if (!response.ok) {\r\n      throw new Error(`Failed to submit order: ${response.status}`);\r\n    }\r\n\r\n    // Handle successful order submission\r\n    const order = await response.json();\r\n    console.log('Order created:', order);\r\n    navigate('/Store');\r\n  } catch (error) {\r\n    console.error(error);\r\n  }\r\n}\r\n\r\n  return (\r\n    <form>\r\n      <h1>Checkout</h1>\r\n      <h2>Total: ${totalPrice.toFixed(2)}</h2>\r\n\r\n      <div className=\"Products\">\r\n        {cartItems.map((item, index) => {\r\n          const product = productDetails[item.product];\r\n          return product ? (\r\n            <div key={index}>\r\n              <h3>{product.name}</h3>\r\n              <p>Price: ${product.price}</p>\r\n              <p>Quantity: {item.quantity}</p>\r\n            </div>\r\n          ) : null;\r\n        })}\r\n      </div>\r\n\r\n      <div className=\"mb-3\">\r\n        {/* Other form fields */}\r\n      </div>\r\n      <div className=\"d-grid\">\r\n        <a href=\"Completion\">\r\n          <button\r\n            type=\"submit\"\r\n            className=\"btn btn-primary\"\r\n            onClick={handleSubmit}\r\n          >\r\n            Submit\r\n          </button>\r\n        </a>\r\n      </div>\r\n    </form>\r\n  );\r\n}\r\n\r\nexport default Checkout;\r\n"],"mappings":"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"},"metadata":{},"sourceType":"module","externalDependencies":[]}